<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StyleCorte Pro - Demo Peluquer√≠a & Barber√≠a</title>
    <meta name="description" content="Sistema de reservas online y gesti√≥n para peluquer√≠as y barber√≠as">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- üìç A√ëADIR: Estilos del Espejo M√°gico -->
    <link rel="stylesheet" href="magic-styles/magic-features.css">
    <link rel="icon" href="assets/images/logo.ico" type="image/x-icon">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="logo">
                <i class="fas fa-scissors"></i>
                <span>StyleCorte Pro</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#servicios">Servicios</a></li>
                <li><a href="#estilistas">Estilistas</a></li>
                <li><a href="#galeria">Galer√≠a</a></li>
                <li><a href="#reservas">Reservas</a></li>
            </ul>
            <div class="nav-cta">
                <button class="btn btn-primary" onclick="openApp()">
                    <i class="fas fa-mobile-alt"></i>
                    Abrir App
                </button>
            </div>
        </nav>
    </header>
    <!-- Hero Section -->
    <section id="inicio" class="hero hero-peluqueria">
        <div class="hero-background"></div>
        <div class="hero-overlay"></div>
        <div class="container hero-container">
            <div class="hero-content">
                <strong class="text-kicker">DEMO INTERACTIVO</strong>
                <h1>StyleCorte Pro App</h1>
                <p>Sistema completo de gesti√≥n para peluquer√≠as y barber√≠as. Reservas online, fidelizaci√≥n de clientes y control de negocio en una sola app.</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="openApp()">
                        <i class="fas fa-play"></i>
                        Probar Demo
                    </button>
                    <button class="btn btn-secondary" onclick="showDashboard()">
                        <i class="fas fa-chart-bar"></i>
                        Ver Dashboard
                    </button>
                </div>
            </div>
            <div class="hero-image">
                <div class="phone-mockup demo-phone">
                    <div class="phone-screen" id="phoneScreen">
                        <!-- Contenido din√°mico de la app -->
                        <div class="app-screen home-screen">
                            <div class="app-header">
                                <div class="app-logo">
                                    <i class="fas fa-scissors"></i>
                                    <span>StyleCorte</span>
                                </div>
                                <div class="app-notification">
                                    <i class="fas fa-bell"></i>
                                </div>
                            </div>
                            <div class="app-welcome">
                                <h3>¬°Bienvenido!</h3>
                                <p>Reserva tu cita f√°cilmente</p>
                            </div>
                            <div class="app-buttons">
                                <button class="app-btn primary" onclick="showServices()">
                                    <i class="fas fa-calendar-check"></i>
                                    Reservar Cita
                                </button>
                                <button class="app-btn secondary" onclick="showFidelizacion()">
                                    <i class="fas fa-crown"></i>
                                    Programa Fidelidad
                                </button>
                                <!-- üìç A√ëADIR: Bot√≥n del Espejo M√°gico -->
                                <button class="app-btn secondary" onclick="showMagicMirror()" style="background: linear-gradient(135deg, #8B4513, #D2691E); color: white; border: none;">
                                    <i class="fas fa-magic"></i>
                                    Espejo M√°gico
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Modal de la App -->
    <div id="appModal" class="modal">
        <div class="modal-content app-modal">
            <span class="close" onclick="closeApp()">&times;</span>
            <div class="app-container">
                <div class="app-header-modal">
                    <div class="app-nav">
                        <button class="nav-btn" onclick="goBack()"><i class="fas fa-arrow-left"></i></button>
                        <h3 id="appTitle">StyleCorte App</h3>
                        <button class="nav-btn" onclick="closeApp()"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <div class="app-content" id="appContent">
                    <!-- Contenido din√°mico de la app -->
                </div>
            </div>
        </div>
    </div>
    <!-- Modal del Dashboard -->
    <div id="dashboardModal" class="modal">
        <div class="modal-content dashboard-modal">
            <span class="close" onclick="closeDashboard()">&times;</span>
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2><i class="fas fa-chart-bar"></i> Dashboard StyleCorte Pro</h2>
                    <p>Panel de control del negocio</p>
                </div>
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <i class="fas fa-calendar-check"></i>
                        <div class="stat-info">
                            <h3>24</h3>
                            <p>Citas Hoy</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <div class="stat-info">
                            <h3>‚Ç¨1,240</h3>
                            <p>Ingresos Hoy</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-star"></i>
                        <div class="stat-info">
                            <h3>4.8</h3>
                            <p>Valoraci√≥n</p>
                        </div>
                    </div>
                </div>
                <div class="dashboard-content">
                    <div class="dashboard-section">
                        <h3>Pr√≥ximas Citas</h3>
                        <div class="citas-list">
                            <div class="cita-item">
                                <div class="cita-info">
                                    <strong>Mar√≠a Gonz√°lez</strong>
                                    <span>Corte y Peinado - 10:00 AM</span>
                                </div>
                                <div class="cita-status confirmed">Confirmada</div>
                            </div>
                            <div class="cita-item">
                                <div class="cita-info">
                                    <strong>Carlos Ruiz</strong>
                                    <span>Barba y Bigote - 11:30 AM</span>
                                </div>
                                <div class="cita-status pending">Pendiente</div>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-section">
                        <h3>Clientes Frecuentes</h3>
                        <div class="clientes-list">
                            <div class="cliente-item">
                                <div class="cliente-avatar">JG</div>
                                <div class="cliente-info">
                                    <strong>Juan Garc√≠a</strong>
                                    <span>12 visitas</span>
                                </div>
                                <div class="cliente-puntos">450 pts</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üìç A√ëADIR: Scripts del Espejo M√°gico -->
    <script src="magic-modules/magic-mirror.js"></script>
    <script src="magic-modules/face-analysis.js"></script>
    <script src="magic-modules/payment-handler.js"></script>
    <script src="js/app.js"></script>

    <!-- üìç A√ëADIR: Integraci√≥n del Espejo M√°gico -->
    <script>
    // üìç CORREGIDO: Cargar recomendaciones de estilos
function loadStyleRecommendations() {
    console.log('üîÑ Cargando recomendaciones...');
    
    if (!window.magicMirror) {
        console.error('‚ùå Magic Mirror no est√° cargado');
        // Mostrar recomendaciones de prueba
        showFallbackRecommendations();
        return;
    }
    
    try {
        const recommendations = window.magicMirror.generateStyleRecommendations();
        console.log('‚úÖ Recomendaciones generadas:', recommendations);
        
        const container = document.getElementById('style-recommendations-list');
        if (container) {
            if (recommendations.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: white; padding: 2rem;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No se pudieron cargar las recomendaciones</p>
                        <button class="btn-magic secondary" onclick="loadStyleRecommendations()">
                            Reintentar
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recommendations.map(style => `
                <div class="style-card" onclick="selectMagicStyle('${style.id}')">
                    <h4>${style.name}</h4>
                    <p>${style.description}</p>
                    <div class="style-meta">
                        <span class="confidence-badge">${style.confidence}% compatible</span>
                        <span class="price-tag">‚Ç¨${style.price}</span>
                    </div>
                </div>
            `).join('');
            
            console.log('üéØ Recomendaciones mostradas en la interfaz');
        } else {
            console.error('‚ùå Contenedor de recomendaciones no encontrado');
            showFallbackRecommendations();
        }
    } catch (error) {
        console.error('‚ùå Error cargando recomendaciones:', error);
        showFallbackRecommendations();
    }
}

// üìç NUEVO: Mostrar recomendaciones de respaldo
function showFallbackRecommendations() {
    const container = document.getElementById('style-recommendations-list');
    if (!container) return;
    
    const fallbackStyles = [
        {
            id: 'fallback-1',
            name: 'üî• Corte Moderno Premium',
            description: 'Estilo vanguardista que combina t√©cnicas modernas con elegancia atemporal.',
            confidence: 92,
            price: 9.99
        },
        {
            id: 'fallback-2', 
            name: 'üíé Elegancia Cl√°sica',
            description: 'Corte tradicional con un toque de sofisticaci√≥n moderna que nunca pasa de moda.',
            confidence: 85,
            price: 7.99
        },
        {
            id: 'fallback-3',
            name: 'üèô Estilo Urbano',
            description: 'Look contempor√°neo perfecto para el d√≠a a d√≠a en la ciudad.',
            confidence: 78,
            price: 6.99
        }
    ];
    
    container.innerHTML = fallbackStyles.map(style => `
        <div class="style-card" onclick="selectMagicStyle('${style.id}')">
            <h4>${style.name}</h4>
            <p>${style.description}</p>
            <div class="style-meta">
                <span class="confidence-badge">${style.confidence}% compatible</span>
                <span class="price-tag">‚Ç¨${style.price}</span>
            </div>
        </div>
    `).join('');
    
    console.log('üîÑ Mostrando recomendaciones de respaldo');
}
        }
        appState.previousScreens.push(appState.currentScreen);
        appState.currentScreen = 'magic-mirror';
        document.getElementById('appTitle').textContent = 'Espejo M√°gico';
        document.getElementById('appContent').innerHTML = `
            <div class="magic-mirror-container">
                <div class="camera-section">
                    <video id="magic-camera" autoplay playsinline></video>
                    <canvas id="magic-overlay"></canvas>
                </div>
                <div class="style-recommendations">
                    <h3 style="text-align: center; margin-bottom: 1rem; color: white;">Estilos Recomendados para Ti</h3>
                    <div id="style-recommendations-list">
                        <!-- Las recomendaciones se cargar√°n aqu√≠ -->
                    </div>
                </div>
                <div class="magic-actions">
                    <button class="btn-magic secondary" onclick="stopMagicCamera()">
                        <i class="fas fa-camera"></i>
                        Parar C√°mara
                    </button>
                    <button class="btn-magic primary" onclick="startMagicExperience()">
                        <i class="fas fa-play"></i>
                        Iniciar An√°lisis
                    </button>
                </div>
            </div>
        `;
        
        // Inicializar c√°mara autom√°ticamente
        setTimeout(() => {
            if (window.magicMirror) {
                window.magicMirror.initCamera().then(() => {
                    loadStyleRecommendations();
                });
            }
        }, 500);
    }

    // Cargar recomendaciones de estilos
    function loadStyleRecommendations() {
        if (!window.magicMirror) {
            console.error('Magic Mirror no est√° cargado');
            return;
        }
        const recommendations = window.magicMirror.generateStyleRecommendations();
        const container = document.getElementById('style-recommendations-list');
        if (container) {
            container.innerHTML = recommendations.map(style => `
                <div class="style-card" onclick="selectMagicStyle('${style.id}')">
                    <h4>${style.name}</h4>
                    <p>${style.description}</p>
                    <div class="style-meta">
                        <span class="confidence-badge">${style.confidence}% compatible</span>
                        <span class="price-tag">‚Ç¨${style.price}</span>
                    </div>
                </div>
            `).join('');
        }
    }

    // Seleccionar estilo m√°gico
    function selectMagicStyle(styleId) {
        if (!window.magicMirror) return;
        const style = window.magicMirror.generateStyleRecommendations().find(s => s.id === styleId);
        if (style) {
            // Aplicar vista previa
            window.magicMirror.applyStylePreview(style.name);
            // Mostrar modal de pago
            setTimeout(() => {
                if (window.paymentHandler) {
                    window.paymentHandler.showPaymentModal(style);
                }
            }, 1000);
        }
    }

    // Iniciar experiencia m√°gica completa
    async function startMagicExperience() {
        if (!window.magicMirror || !window.faceAnalysis) {
            alert('Sistema m√°gico no cargado correctamente');
            return;
        }
        const startBtn = document.querySelector('.btn-magic.primary');
        if (!startBtn) return;
        const originalText = startBtn.innerHTML;
        startBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analizando...';
        startBtn.disabled = true;
        try {
            // Simular an√°lisis facial
            const faceData = await window.faceAnalysis.analyzeFace(document.getElementById('magic-camera'));
            // Cargar recomendaciones basadas en el an√°lisis
            loadStyleRecommendations();
            startBtn.innerHTML = '<i class="fas fa-check"></i> An√°lisis Completo';
            setTimeout(() => {
                startBtn.innerHTML = originalText;
                startBtn.disabled = false;
            }, 2000);
        } catch (error) {
            console.error('Error en an√°lisis:', error);
            startBtn.innerHTML = originalText;
            startBtn.disabled = false;
            alert('Error en el an√°lisis. Por favor intenta nuevamente.');
        }
    }

    // Detener c√°mara m√°gica
    function stopMagicCamera() {
        if (window.magicMirror) {
            window.magicMirror.stopCamera();
        }
    }

    // Asegurar que la c√°mara se detenga al cerrar la app
    document.addEventListener('DOMContentLoaded', function() {
        console.log('StyleCorte Pro con Espejo M√°gico cargado');
        // Sobrescribir closeApp si existe
        if (typeof closeApp !== 'undefined') {
            const originalCloseApp = closeApp;
            closeApp = function() {
                if (window.magicMirror) {
                    window.magicMirror.stopCamera();
                }
                originalCloseApp();
            };
        }
    });
    </script>
</body>
</html>

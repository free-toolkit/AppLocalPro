<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GastroNeo: Restaurante del Futuro con IA, Gamificaci√≥n y Neo-Glassmorphism">
    <title>GastroNeo ‚Äì Revoluci√≥n Gastron√≥mica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* === VARIABLES NEO-GLASSMORPHISM === */
        :root {
            --neo-primary: #FF2A6D;
            --neo-secondary: #00F0FF;
            --neo-accent: #FFD300;
            --neo-purple: #6E00FF;
            --neo-bg: #0D0916;
            --neo-bg-light: #1A0A10;
            --neo-text: #FFD6E0;
            --neo-text-secondary: #D0B0C0;
        }

        /* === ESTILOS BASE === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: var(--neo-bg);
            color: var(--neo-text);
            overflow-x: hidden;
            font-family: 'Rajdhani', sans-serif;
            min-height: 100vh;
        }

        .app-container {
            max-width: 500px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--neo-bg-light);
            position: relative;
            overflow: hidden;
        }

        /* === NEO-GLASSMORPHISM === */
        .neo-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .neo-holographic {
            background: linear-gradient(125deg, 
                rgba(255, 42, 109, 0.1) 0%,
                rgba(0, 240, 255, 0.1) 50%,
                rgba(110, 0, 255, 0.1) 100%);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 240, 255, 0.3);
        }

        .neo-holographic::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent
            );
            animation: hologram-shine 3s infinite;
        }

        @keyframes hologram-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* === HEADER HOLOGR√ÅFICO === */
        .app-header {
            background: linear-gradient(135deg, var(--neo-primary), var(--neo-accent));
            padding: 1.2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.6), 
                transparent
            );
            animation: header-shine 4s infinite;
        }

        @keyframes header-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .app-header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 900;
            color: white;
            position: relative;
            z-index: 1;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            letter-spacing: 2px;
        }

        /* === CONTENIDO PRINCIPAL === */
        .app-content {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: rgba(34, 15, 24, 0.7);
        }

        .view { display: none; }
        .view.active { display: block; }

        /* === SPLASH SCREEN === */
        #splashScreen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--neo-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            overflow: hidden;
        }

        .splash-logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--neo-primary), var(--neo-accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 0 50px rgba(255, 42, 109, 0.8);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .splash-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            color: var(--neo-secondary);
            text-shadow: 0 0 15px rgba(0, 240, 255, 0.8);
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* === BOTONES NEO === */
        .btn-neo {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-family: 'Rajdhani', sans-serif;
            cursor: pointer;
            margin: 0.8rem 0;
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary { 
            background: linear-gradient(135deg, var(--neo-primary), #D10047); 
            color: white; 
        }

        .btn-secondary { 
            background: linear-gradient(135deg, var(--neo-secondary), #00B8FF); 
            color: var(--neo-bg); 
        }

        .btn-accent { 
            background: linear-gradient(135deg, var(--neo-accent), #FF9A00); 
            color: var(--neo-bg); 
        }

        .btn-purple { 
            background: linear-gradient(135deg, var(--neo-purple), #3A00B8); 
            color: white; 
        }

        /* === NAVEGACI√ìN === */
        .app-nav {
            display: flex;
            justify-content: space-around;
            background: rgba(10, 7, 10, 0.9);
            border-top: 1px solid var(--neo-primary);
            padding: 0.8rem 0;
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--neo-text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            font-family: 'Rajdhani', sans-serif;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem;
        }

        .nav-item.active, .nav-item:hover {
            color: var(--neo-accent);
            transform: translateY(-2px);
        }

        .nav-item i { 
            font-size: 1.4rem; 
            margin-bottom: 0.3rem; 
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--neo-primary);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            border-radius: 50%;
            min-width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* === NOTIFICACIONES === */
        .notification-container {
            position: fixed;
            top: 80px;
            right: 10px;
            z-index: 1000;
            max-width: 300px;
        }

        .notification {
            background: var(--neo-bg-light);
            border-left: 4px solid;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            animation: slideInRight 0.3s ease;
        }

        .notification.warning { border-color: var(--neo-accent); }
        .notification.danger { border-color: var(--neo-primary); }
        .notification.success { border-color: var(--neo-secondary); }

        /* === GAMIFICACI√ìN === */
        .leaderboard {
            background: rgba(20, 5, 10, 0.8);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid var(--neo-primary);
        }

        .leaderboard-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--neo-accent);
            text-align: center;
            margin-bottom: 1rem;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .rank-badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            margin-right: 1rem;
        }

        .rank-diamante { background: linear-gradient(135deg, #00FFFF, #0080FF); }
        .rank-oro { background: linear-gradient(135deg, #FFD700, #FFA500); }
        .rank-plata { background: linear-gradient(135deg, #E5E4E2, #A8A8A8); }
        .rank-bronce { background: linear-gradient(135deg, #CD7F32, #8B4513); }

        /* === MEN√ö DIGITAL === */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .menu-card {
            background: rgba(25, 10, 15, 0.7);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(255, 42, 109, 0.3);
            transition: all 0.3s ease;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 42, 109, 0.3);
        }

        .menu-card-img {
            height: 140px;
            overflow: hidden;
        }

        .menu-card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .menu-card-body {
            padding: 1rem;
        }

        .menu-card-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: var(--neo-accent);
            margin-bottom: 0.5rem;
        }

        .menu-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .menu-card-price {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            color: var(--neo-primary);
            font-size: 1.1rem;
        }

        .menu-card-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--neo-primary), #D10047);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-card-btn:hover {
            transform: scale(1.1);
        }

        /* === FORMULARIOS === */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem;
            background: rgba(30, 10, 15, 0.6);
            color: var(--neo-text);
            border: 1px solid var(--neo-primary);
            border-radius: 8px;
            font-family: 'Rajdhani', sans-serif;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--neo-text-secondary);
        }

        /* === CARRITO === */
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            background: rgba(30, 10, 15, 0.6);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border: 1px solid rgba(255, 42, 109, 0.3);
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--neo-primary);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            transform: scale(1.1);
        }

        .cart-total {
            background: linear-gradient(135deg, #2A1018, #3A1525);
            padding: 1rem;
            border-radius: 12px;
            margin: 1rem 0;
            text-align: center;
            border: 1px solid var(--neo-primary);
        }

        /* === MESAS CAMAREROS === */
        .tables-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 1rem 0;
        }

        .table-card {
            height: 80px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            border: 2px solid;
            transition: all 0.3s ease;
        }

        .table-card:hover {
            transform: scale(1.05);
        }

        .table-free {
            background: rgba(40, 20, 30, 0.6);
            border-color: #333;
            color: #888;
        }

        .table-occupied {
            background: linear-gradient(135deg, #2A1018, #3A1525);
            border-color: var(--neo-primary);
            color: var(--neo-accent);
        }

        /* === ACTIVIDAD EN VIVO === */
        .activity-feed {
            max-height: 200px;
            overflow-y: auto;
            margin: 1rem 0;
        }

        .activity-item {
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            font-size: 0.8rem;
            border-left: 3px solid;
            animation: fadeInUp 0.5s ease;
        }

        .activity-positive { border-color: var(--neo-secondary); }
        .activity-negative { border-color: var(--neo-primary); }
        .activity-neutral { border-color: var(--neo-text-secondary); }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* === ESTADOS VAC√çOS === */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--neo-text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--neo-primary);
        }

        /* === SCROLLBAR PERSONALIZADO === */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--neo-primary), var(--neo-secondary));
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen">
        <div class="splash-logo">
            <i class="fas fa-utensils"></i>
        </div>
        <div class="splash-text">GASTRONEO QUANTUM</div>
        <div style="margin-top: 1rem; font-family: 'Rajdhani'; color: var(--neo-text-secondary);">
            Iniciando sistema...
        </div>
    </div>

    <!-- Sistema de Notificaciones -->
    <div class="notification-container" id="notificationContainer"></div>

    <div class="app-container">
        <!-- ========== HOME VIEW ========== -->
        <div id="homeView" class="view active">
            <div class="app-header">
                <h1>GASTRONEO QUANTUM</h1>
            </div>
            <div class="app-content">
                <div id="authOrProfile"></div>

                <button class="btn-neo btn-primary" onclick="showView('bookingView')">
                    <i class="fas fa-calendar-plus"></i> Reservar Mesa
                </button>
                <button class="btn-neo btn-secondary" onclick="showView('qrScannerView')">
                    <i class="fas fa-qrcode"></i> Escanear Mesa
                </button>
                <button class="btn-neo btn-accent" onclick="showView('menuView')">
                    <i class="fas fa-book-open"></i> Men√∫ Digital
                </button>
                <button class="btn-neo btn-purple" onclick="showView('rewardsView')">
                    <i class="fas fa-coins"></i> Mi GastroPass
                </button>

                <div class="neo-glass" style="padding: 1rem; margin: 1.5rem 0;">
                    <div style="font-family: 'Orbitron'; color: var(--neo-secondary); text-align: center; margin-bottom: 0.8rem;">
                        üöÄ ACCESO EMPLEADOS
                    </div>
                    <button class="btn-neo" style="background: rgba(0,240,255,0.2); color: var(--neo-secondary); border: 1px solid var(--neo-secondary);" 
                            onclick="showView('employeeLoginView')">
                        <i class="fas fa-user-tie"></i> Panel Empleados
                    </button>
                    <button class="btn-neo" style="background: rgba(255,42,109,0.2); color: var(--neo-primary); border: 1px solid var(--neo-primary);" 
                            onclick="openOwnerAccess()">
                        <i class="fas fa-user-lock"></i> Panel Quantum
                    </button>
                </div>

                <div class="activity-feed" id="liveActivityFeed">
                    <!-- Las actividades se cargan din√°micamente -->
                </div>
            </div>
        </div>

        <!-- ========== RESERVAS ========== -->
        <div id="bookingView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-calendar-plus"></i> Reservar Mesa</h1>
            </div>
            <div class="app-content">
                <div class="form-group">
                    <label>Nombre Completo</label>
                    <input type="text" id="clientName" class="form-control" placeholder="Ej. Carlos Ruiz">
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" id="clientPhone" class="form-control" placeholder="+34 600 000 000">
                </div>
                <div class="form-group">
                    <label>Fecha</label>
                    <input type="date" id="bookingDate" class="form-control">
                </div>
                <div class="form-group">
                    <label>Hora</label>
                    <select id="bookingTime" class="form-control">
                        <option value="13:00">13:00</option>
                        <option value="13:30">13:30</option>
                        <option value="14:00">14:00</option>
                        <option value="20:00">20:00</option>
                        <option value="20:30">20:30</option>
                        <option value="21:00">21:00</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Comensales</label>
                    <select id="guests" class="form-control">
                        <option>1</option><option>2</option><option>3</option><option>4</option>
                        <option>5</option><option>6</option><option>7</option><option>8</option>
                    </select>
                </div>
                <button class="btn-neo btn-primary" onclick="confirmBooking()">
                    <i class="fas fa-check"></i> Confirmar Reserva
                </button>
                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;" onclick="showView('homeView')">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </div>
        </div>

        <!-- ========== ESCANER QR ========== -->
        <div id="qrScannerView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-qrcode"></i> Escanear Mesa</h1>
            </div>
            <div class="app-content" style="text-align: center;">
                <div style="margin: 2rem 0;">
                    <i class="fas fa-qrcode" style="font-size: 4rem; color: var(--neo-secondary);"></i>
                    <div style="font-family: 'Rajdhani'; font-size: 1.1rem; color: var(--neo-accent); margin: 1rem 0;">
                        Escanea el c√≥digo QR de tu mesa
                    </div>
                </div>
                
                <div class="neo-glass" style="padding: 2rem; margin: 1.5rem 0;">
                    <div class="scanner-icon">
                        <i class="fas fa-camera" style="font-size: 3rem; color: var(--neo-secondary);"></i>
                    </div>
                    <div style="color: var(--neo-text-secondary); margin: 1.5rem 0;">
                        C√°mara lista para escanear...
                    </div>
                    <button class="btn-neo btn-secondary" onclick="simulateQRScan()">
                        <i class="fas fa-camera"></i> Simular Escaneo
                    </button>
                </div>

                <div style="background: rgba(255, 42, 109, 0.1); border-radius: 12px; padding: 1rem; margin: 1.5rem 0;">
                    <div style="color: var(--neo-accent); font-family: 'Rajdhani'; margin-bottom: 0.5rem;">
                        <i class="fas fa-lightbulb"></i> ¬øC√≥mo escanear?
                    </div>
                    <div style="color: var(--neo-text-secondary); font-size: 0.9rem; text-align: left;">
                        1. Enfoca el c√≥digo QR de tu mesa<br>
                        2. La app detectar√° autom√°ticamente<br>
                        3. ¬°Accede al men√∫ digital!
                    </div>
                </div>

                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;" onclick="showView('homeView')">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </div>
        </div>

        <!-- ========== MEN√ö DIGITAL ========== -->
        <div id="menuView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-book-open"></i> Men√∫ Digital</h1>
            </div>
            <div class="app-content">
                <div id="mesaInfo" style="background: rgba(0, 240, 255, 0.1); border-radius: 8px; padding: 0.8rem; margin-bottom: 1rem; display: none;">
                    <div style="color: var(--neo-secondary); font-family: 'Orbitron'; font-size: 0.9rem;">
                        <i class="fas fa-table"></i> Mesa: <span id="currentMesa">-</span>
                    </div>
                </div>

                <div class="menu-category">
                    <h2 style="font-family: 'Orbitron'; color: var(--neo-primary); margin: 1.5rem 0 1rem; border-bottom: 2px solid var(--neo-primary); padding-bottom: 0.5rem;">
                        üçΩÔ∏è ENTRADAS
                    </h2>
                    <div class="menu-grid">
                        <div class="menu-card">
                            <div class="menu-card-img">
                                <img src="https://images.pexels.com/photos/3764643/pexels-photo-3764643.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Tartar de At√∫n">
                            </div>
                            <div class="menu-card-body">
                                <h3 class="menu-card-name">Tartar de At√∫n</h3>
                                <p style="color: var(--neo-text-secondary); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                                    At√∫n fresco con wasabi y aguacate, marinado en salsa de soja y aceite de s√©samo
                                </p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">‚Ç¨16.50</span>
                                    <button class="menu-card-btn" onclick="addToCart('Tartar de At√∫n', 16.50)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="menu-card">
                            <div class="menu-card-img">
                                <img src="https://images.pexels.com/photos/7049761/pexels-photo-7049761.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Bruschetta">
                            </div>
                            <div class="menu-card-body">
                                <h3 class="menu-card-name">Bruschetta</h3>
                                <p style="color: var(--neo-text-secondary); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                                    Pan tostado artesanal con tomate fresco, albahaca y aceite de oliva virgen extra
                                </p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">‚Ç¨9.90</span>
                                    <button class="menu-card-btn" onclick="addToCart('Bruschetta', 9.90)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="menu-category">
                    <h2 style="font-family: 'Orbitron'; color: var(--neo-primary); margin: 1.5rem 0 1rem; border-bottom: 2px solid var(--neo-primary); padding-bottom: 0.5rem;">
                        üçù PLATOS FUERTES
                    </h2>
                    <div class="menu-grid">
                        <div class="menu-card">
                            <div class="menu-card-img">
                                <img src="https://images.pexels.com/photos/1199381/pexels-photo-1199381.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Pasta Carbonara">
                            </div>
                            <div class="menu-card-body">
                                <h3 class="menu-card-name">Pasta Carbonara</h3>
                                <p style="color: var(--neo-text-secondary); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                                    Pasta fresca con salsa cremosa de panceta, huevo y queso pecorino
                                </p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">‚Ç¨18.99</span>
                                    <button class="menu-card-btn" onclick="addToCart('Pasta Carbonara', 18.99)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="menu-card">
                            <div class="menu-card-img">
                                <img src="https://images.pexels.com/photos/1624487/pexels-photo-1624487.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Risotto de Trufa">
                            </div>
                            <div class="menu-card-body">
                                <h3 class="menu-card-name">Risotto de Trufa</h3>
                                <p style="color: var(--neo-text-secondary); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                                    Arroz arb√≥reo cremoso con trufa negra fresca y queso parmesano
                                </p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">‚Ç¨24.00</span>
                                    <button class="menu-card-btn" onclick="addToCart('Risotto de Trufa', 24.00)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="menu-category">
                    <h2 style="font-family: 'Orbitron'; color: var(--neo-primary); margin: 1.5rem 0 1rem; border-bottom: 2px solid var(--neo-primary); padding-bottom: 0.5rem;">
                        üç∞ POSTRES
                    </h2>
                    <div class="menu-grid">
                        <div class="menu-card">
                            <div class="menu-card-img">
                                <img src="https://images.pexels.com/photos/733857/pexels-photo-733857.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Tiramis√∫">
                            </div>
                            <div class="menu-card-body">
                                <h3 class="menu-card-name">Tiramis√∫</h3>
                                <p style="color: var(--neo-text-secondary); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                                    Capas de bizcocho de soletilla empapado en caf√© y crema de mascarpone
                                </p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">‚Ç¨8.99</span>
                                    <button class="menu-card-btn" onclick="addToCart('Tiramis√∫', 8.99)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;margin-top:1.5rem;" onclick="showView('homeView')">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </div>
        </div>

        <!-- ========== CARRITO ========== -->
        <div id="cartView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-shopping-cart"></i> Mi Carrito</h1>
            </div>
            <div class="app-content">
                <div id="mesaInfoCart" style="background: rgba(0, 240, 255, 0.1); border-radius: 8px; padding: 0.8rem; margin-bottom: 1rem; display: none;">
                    <div style="color: var(--neo-secondary); font-family: 'Orbitron'; font-size: 0.9rem;">
                        <i class="fas fa-table"></i> Mesa: <span id="currentMesaCart">-</span>
                    </div>
                </div>

                <div id="cartItemsContainer"></div>
                
                <div id="emptyCart" class="empty-state" style="display: none;">
                    <i class="fas fa-shopping-cart"></i>
                    <h3>Tu carrito est√° vac√≠o</h3>
                    <p>¬°A√±ade algunos productos deliciosos!</p>
                </div>

                <div id="cartSummary" style="display: none;">
                    <div class="cart-total">
                        <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Total del Pedido</div>
                        <div style="font-family: 'Orbitron'; font-size: 1.8rem; color: var(--neo-accent); margin: 0.5rem 0;" id="cartTotalAmount">‚Ç¨0.00</div>
                    </div>
                    
                    <button class="btn-neo btn-primary" onclick="showView('checkoutView')">
                        <i class="fas fa-credit-card"></i> Proceder al Pago
                    </button>
                </div>

                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;" onclick="showView('menuView')">
                    <i class="fas fa-arrow-left"></i> Seguir Comprando
                </button>
            </div>
        </div>

        <!-- ========== CHECKOUT ========== -->
        <div id="checkoutView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-credit-card"></i> Checkout</h1>
            </div>
            <div class="app-content">
                <div class="form-group">
                    <label>Nombre Completo</label>
                    <input type="text" id="checkoutName" class="form-control" placeholder="Como aparece en la tarjeta">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="checkoutEmail" class="form-control" placeholder="tu@email.com">
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" id="checkoutPhone" class="form-control" placeholder="+34 600 000 000">
                </div>

                <div style="background:rgba(30,10,15,0.6); padding:1rem; border-radius:12px; margin:1.5rem 0;">
                    <h3 style="font-family:'Rajdhani';color:var(--neo-accent);margin:0 0 0.8rem;">Resumen del Pedido</h3>
                    <div id="checkoutOrderItems"></div>
                    <div style="font-family:'Orbitron';color:var(--neo-primary);font-size:1.3rem;margin-top:0.8rem;">
                        Total: ‚Ç¨<span id="checkoutTotal">0.00</span>
                    </div>
                </div>

                <h3 style="font-family:'Rajdhani';color:var(--neo-accent);margin:1.5rem 0 1rem;">M√©todo de Pago</h3>
                <div style="display: grid; gap: 0.8rem; margin: 1.5rem 0;">
                    <button class="btn-neo" style="background:linear-gradient(135deg, #6E00FF, #3A00B8); color:white;" onclick="selectPaymentMethod('card')">
                        <i class="fas fa-credit-card"></i> Tarjeta de Cr√©dito
                    </button>
                    <button class="btn-neo" style="background:linear-gradient(135deg, #00F0FF, #00B8FF); color:var(--neo-bg);" onclick="selectPaymentMethod('cash')">
                        <i class="fas fa-money-bill-wave"></i> Efectivo
                    </button>
                    <button class="btn-neo" style="background:linear-gradient(135deg, #0070BA, #009CDE); color:white;" onclick="selectPaymentMethod('paypal')">
                        <i class="fab fa-paypal"></i> PayPal
                    </button>
                </div>

                <button class="btn-neo btn-primary" onclick="processCheckout()" id="checkoutBtn">
                    <i class="fas fa-lock"></i> Pagar Ahora
                </button>
                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;" onclick="showView('cartView')">
                    <i class="fas fa-arrow-left"></i> Volver al Carrito
                </button>
            </div>
        </div>

        <!-- ========== GASTROPASS ========== -->
        <div id="rewardsView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-coins"></i> Mi GastroPass</h1>
            </div>
            <div class="app-content">
                <div class="neo-glass" style="text-align:center; padding:1.5rem; margin-bottom:1.5rem;">
                    <div style="font-family:'Orbitron';font-size:1.3rem;color:var(--neo-accent);margin-bottom:0.5rem;">ü•â Bronce</div>
                    <div style="font-size:0.9rem;color:var(--neo-text-secondary);margin-bottom:0.8rem;">Progreso hacia Plata</div>
                    <div style="background:rgba(0,0,0,0.3);height:12px;border-radius:10px;overflow:hidden;margin:0 0.5rem;">
                        <div style="height:100%;background:linear-gradient(90deg,var(--neo-primary),var(--neo-accent));width:56%;"></div>
                    </div>
                    <div style="font-size:0.85rem;color:var(--neo-text);margin-top:0.5rem;">280 / 500 pts</div>
                </div>

                <div class="neo-glass" style="padding:1.2rem; margin-bottom:1.5rem;">
                    <h3 style="font-family:'Rajdhani';color:var(--neo-accent);margin-bottom:1rem;">üéÅ Tus Beneficios</h3>
                    <div style="font-size:0.95rem;line-height:1.6;">
                        <div>‚Ä¢ Men√∫ digital exclusivo</div>
                        <div>‚Ä¢ Cumplea√±os gratis</div>
                        <div>‚Ä¢ Acceso a eventos del chef</div>
                        <div>‚Ä¢ Descuentos especiales</div>
                        <div>‚Ä¢ Atenci√≥n prioritaria</div>
                    </div>
                </div>

                <h3 style="font-family:'Rajdhani';color:var(--neo-accent);margin-bottom:0.8rem;">üõí Canjear Recompensas</h3>
                <div style="display: grid; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
                        <div><strong>Caf√© Gourmet</strong><br><small>100 pts</small></div>
                        <button style="width:32px;height:32px;border-radius:50%;background:var(--neo-accent);color:var(--neo-bg);border:none;cursor:pointer;transition:all 0.2s ease;" 
                                onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"
                                onclick="redeemReward(100, 'Caf√© Gourmet')">
                            <i class="fas fa-gift"></i>
                        </button>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
                        <div><strong>Postre del Chef</strong><br><small>250 pts</small></div>
                        <button style="width:32px;height:32px;border-radius:50%;background:var(--neo-accent);color:var(--neo-bg);border:none;cursor:pointer;transition:all 0.2s ease;" 
                                onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"
                                onclick="redeemReward(250, 'Postre del Chef')">
                            <i class="fas fa-gift"></i>
                        </button>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
                        <div><strong>Copa de Vino</strong><br><small>300 pts</small></div>
                        <button style="width:32px;height:32px;border-radius:50%;background:var(--neo-accent);color:var(--neo-bg);border:none;cursor:pointer;transition:all 0.2s ease;" 
                                onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"
                                onclick="redeemReward(300, 'Copa de Vino')">
                            <i class="fas fa-gift"></i>
                        </button>
                    </div>
                </div>

                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;margin-top:1.5rem;" onclick="showView('homeView')">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </div>
        </div>

        <!-- ========== LOGIN EMPLEADOS ========== -->
        <div id="employeeLoginView" class="view">
            <div class="app-header">
                <h1><i class="fas fa-user-tie"></i> Acceso Empleados</h1>
            </div>
            <div class="app-content" style="text-align: center;">
                <div style="margin:2rem 0;">
                    <i class="fas fa-key" style="font-size:3rem;color:var(--neo-primary);"></i>
                    <div style="margin-top:1rem;font-family:'Rajdhani';font-size:1.1rem;">Ingresa tu PIN de empleado</div>
                </div>
                <input type="password" id="employeePin" class="form-control" placeholder="****" style="max-width:200px;margin:0 auto; text-align: center; font-size: 1.2rem; letter-spacing: 0.3rem;">
                <button class="btn-neo btn-primary" onclick="loginEmployee()" style="margin-top:1.5rem;">
                    <i class="fas fa-sign-in-alt"></i> Ingresar
                </button>
                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;margin-top:1rem;" onclick="showView('homeView')">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </div>
        </div>

        <!-- ========== PANEL EMPLEADOS ========== -->
        <div id="employeeDashboard" class="view">
            <div class="app-header">
                <h1><i class="fas fa-concierge-bell"></i> Panel Empleados</h1>
            </div>
            <div class="app-content">
                <div class="leaderboard">
                    <div class="leaderboard-title">üèÜ TABLERO DE EMPLEADOS</div>
                    <div id="employeeLeaderboard"></div>
                </div>

                <h3 style="font-family:'Rajdhani';color:var(--neo-accent);margin:1.5rem 0 1rem;">üìã Gesti√≥n de Mesas</h3>
                <div class="tables-grid" id="tablesGrid"></div>

                <button class="btn-neo" style="background:#3A1525;color:#E0C0D0;margin-top:1.5rem;" onclick="logoutEmployee()">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                </button>
            </div>
        </div>

        <!-- ========== PANEL QUANTUM (DUE√ëO) ========== -->
        <div id="ownerDashboard" class="view">
            <div class="app-header">
                <h1><i class="fas fa-user-lock"></i> Panel Quantum</h1>
            </div>
            <div class="app-content">
                <div class="neo-glass" style="padding:1rem; margin-bottom:1.5rem;">
                    <div style="font-family:'Orbitron';color:var(--neo-accent);font-size:1.1rem;margin-bottom:0.8rem;">üìä RESUMEN DEL D√çA</div>
                    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:0.6rem;font-size:0.9rem;">
                        <div><strong>Ingresos:</strong> <span id="dailyRevenue">‚Ç¨420</span></div>
                        <div><strong>Mesas ocupadas:</strong> <span id="occupiedTables">8/12</span></div>
                        <div><strong>Pedidos pendientes:</strong> <span id="pendingOrders">3</span></div>
                        <div><strong>Clientes en espera:</strong> <span id="waitingClients">2</span></div>
                    </div>
                </div>

                <div class="leaderboard">
                    <div class="leaderboard-title">‚ö° EMPLEADOS DESTACADOS</div>
                    <div id="ownerLeaderboard"></div>
                </div>

                <button class="btn-neo btn-primary" onclick="verifyAllOrders()">
                    <i class="fas fa-check-double"></i> Verificar Todos los Pedidos
                </button>
                <button class="btn-neo" style="background:#e74c3c;color:white;margin-top:1rem;" onclick="logoutOwner()">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                </button>
            </div>
        </div>
    </div>

    <!-- Navegaci√≥n Inferior -->
    <div class="app-nav">
        <a href="#" class="nav-item active" onclick="showView('homeView'); return false;">
            <i class="fas fa-home"></i>
            <span>Inicio</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('bookingView'); return false;">
            <i class="fas fa-calendar"></i>
            <span>Reservas</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('menuView'); return false;">
            <i class="fas fa-book"></i>
            <span>Men√∫</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('qrScannerView'); return false;">
            <i class="fas fa-qrcode"></i>
            <span>Escanear</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('cartView'); return false;" id="cartNavItem">
            <i class="fas fa-shopping-cart"></i>
            <span>Carrito</span>
            <div class="cart-badge" id="cartBadge" style="display: none;">0</div>
        </a>
    </div>

    <script>
        // === ESTADO GLOBAL ===
        let appState = {
            user: null,
            employee: null,
            cart: JSON.parse(localStorage.getItem('gastroneo_cart')) || [],
            employees: [
                { id: 'emp_1', name: 'Carlos Rodr√≠guez', points: 850, level: 'diamante', todayPoints: 45 },
                { id: 'emp_2', name: 'Ana Mart√≠nez', points: 720, level: 'oro', todayPoints: 32 },
                { id: 'emp_3', name: 'Luis Garc√≠a', points: 450, level: 'plata', todayPoints: -12 },
                { id: 'emp_4', name: 'Mar√≠a L√≥pez', points: 380, level: 'bronce', todayPoints: 18 }
            ],
            activities: [],
            selectedPaymentMethod: null
        };

        // === INICIALIZACI√ìN ===
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
                initializeApp();
            }, 2500);
        });

        function initializeApp() {
            loadUser();
            updateCartBadge();
            checkMesaEscaneada();
            startLiveActivities();
            renderEmployeeLeaderboard();
            renderTablesGrid();
            renderOwnerLeaderboard();
            
            // Mostrar notificaci√≥n de bienvenida
            setTimeout(() => {
                createNotification('success', '¬°Bienvenido!', 'Sistema GastroNeo Quantum iniciado correctamente');
            }, 3000);
        }

        // === SISTEMA DE VISTAS ===
        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            
            const viewToNavMap = {
                'homeView': 0, 'bookingView': 1, 'menuView': 2, 'qrScannerView': 3, 'cartView': 4
            };
            
            if (viewToNavMap[viewId] !== undefined) {
                document.querySelectorAll('.nav-item')[viewToNavMap[viewId]].classList.add('active');
            }

            // Acciones espec√≠ficas por vista
            if (viewId === 'cartView') renderCart();
            if (viewId === 'checkoutView') renderCheckout();
            if (viewId === 'employeeDashboard') renderEmployeeDashboard();
        }

        // === SISTEMA DE USUARIOS ===
        function loadUser() {
            const user = JSON.parse(localStorage.getItem('gastroneo_user'));
            if (user) {
                appState.user = user;
                renderUserProfile();
            } else {
                renderAuthSection();
            }
        }

        function renderUserProfile() {
            const container = document.getElementById('authOrProfile');
            container.innerHTML = `
                <div class="neo-glass" style="padding: 1rem; text-align: center; margin-bottom: 1rem;">
                    <div style="font-family: 'Orbitron'; color: var(--neo-accent); font-size: 1.2rem;">
                        üëã Hola, ${appState.user.name}
                    </div>
                    <div style="color: var(--neo-secondary); margin-top: 0.5rem;">
                        <i class="fas fa-coins"></i> ${appState.user.tokens || 0} GastroTokens
                    </div>
                    <div style="margin-top: 0.8rem;">
                        <button class="btn-neo" style="background: rgba(255,42,109,0.2); color: var(--neo-primary); border: 1px solid var(--neo-primary); padding: 0.5rem; font-size: 0.9rem;" onclick="logoutUser()">
                            <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                        </button>
                    </div>
                </div>
            `;
        }

        function renderAuthSection() {
            const container = document.getElementById('authOrProfile');
            container.innerHTML = `
                <div class="neo-holographic" style="padding: 1.5rem; text-align: center; margin-bottom: 1.5rem; border-radius: 16px;">
                    <div style="font-family: 'Orbitron'; color: var(--neo-accent); font-size: 1.3rem; margin-bottom: 1rem;">
                        üöÄ ¬øNUEVO EN GASTRONEO?
                    </div>
                    <div style="color: var(--neo-text-secondary); margin-bottom: 1.5rem; line-height: 1.5;">
                        Crea tu GastroPass y accede a recompensas exclusivas del futuro.
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button class="btn-neo btn-accent" onclick="showSignupModal()">
                            <i class="fas fa-user-plus"></i> Crear Cuenta
                        </button>
                        <button class="btn-neo btn-primary" onclick="showLoginModal()">
                            <i class="fas fa-sign-in-alt"></i> Iniciar Sesi√≥n
                        </button>
                    </div>
                </div>
            `;
        }

        function showSignupModal() {
            const name = prompt("üë§ ¬øCu√°l es tu nombre?");
            const email = prompt("üìß ¬øCu√°l es tu email?");
            if (name && email) {
                appState.user = { 
                    name: name.trim(), 
                    email: email, 
                    tokens: 100,
                    joinDate: new Date().toISOString()
                };
                localStorage.setItem('gastroneo_user', JSON.stringify(appState.user));
                alert("üéâ ¬°Bienvenido a GastroNeo Quantum!\nüéÅ 100 GastroTokens de bienvenida.");
                renderUserProfile();
                createNotification('success', '¬°Cuenta Creada!', `Bienvenido ${name}, empieza a ganar recompensas`);
                addActivity('positive', `Nuevo usuario: ${name} se uni√≥ a GastroNeo`);
            }
        }

        function showLoginModal() {
            const name = prompt("üë§ Ingresa tu nombre:");
            if (name) {
                const existing = JSON.parse(localStorage.getItem('gastroneo_user'));
                if (existing && existing.name === name.trim()) {
                    appState.user = existing;
                    renderUserProfile();
                    alert(`¬°Bienvenido de nuevo, ${name}!`);
                    createNotification('success', '¬°Bienvenido!', 'Sesi√≥n iniciada correctamente');
                } else {
                    alert("‚ùå Usuario no encontrado. Cr√©ate una cuenta primero.");
                }
            }
        }

        function logoutUser() {
            appState.user = null;
            localStorage.removeItem('gastroneo_user');
            renderAuthSection();
            alert("üëã Sesi√≥n cerrada correctamente");
        }

        // === SISTEMA DE CARRITO ===
        function addToCart(name, price) {
            const existingItem = appState.cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                appState.cart.push({ name, price, quantity: 1 });
            }
            
            localStorage.setItem('gastroneo_cart', JSON.stringify(appState.cart));
            updateCartBadge();
            
            // Efecto visual
            const btn = event.target.closest('.menu-card-btn');
            const originalHTML = btn.innerHTML;
            const originalBackground = btn.style.background;
            
            btn.innerHTML = '<i class="fas fa-check"></i>';
            btn.style.background = 'linear-gradient(135deg, #00D100, #009900)';
            
            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.style.background = originalBackground;
            }, 1000);
            
            createNotification('success', 'üõí Producto A√±adido', `${name} a√±adido al carrito`);
        }

        function updateCartBadge() {
            const badge = document.getElementById('cartBadge');
            const totalItems = appState.cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (totalItems > 0) {
                badge.textContent = totalItems;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function renderCart() {
            const container = document.getElementById('cartItemsContainer');
            const emptyCart = document.getElementById('emptyCart');
            const cartSummary = document.getElementById('cartSummary');
            const totalAmount = document.getElementById('cartTotalAmount');
            
            if (appState.cart.length === 0) {
                emptyCart.style.display = 'block';
                cartSummary.style.display = 'none';
                container.innerHTML = '';
                return;
            }
            
            emptyCart.style.display = 'none';
            cartSummary.style.display = 'block';
            
            let total = 0;
            container.innerHTML = appState.cart.map(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                return `
                    <div class="cart-item">
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: var(--neo-accent); font-size: 1rem;">${item.name}</div>
                            <div style="color: var(--neo-primary); font-size: 0.9rem;">‚Ç¨${item.price.toFixed(2)} c/u</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', -1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span style="margin: 0 0.5rem; min-width: 20px; text-align: center; font-weight: 600;">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', 1)">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="quantity-btn" onclick="removeFromCart('${item.name}')" style="background: #e74c3c;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            totalAmount.textContent = `‚Ç¨${total.toFixed(2)}`;
        }

        function updateQuantity(itemName, change) {
            const item = appState.cart.find(item => item.name === itemName);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(itemName);
                } else {
                    localStorage.setItem('gastroneo_cart', JSON.stringify(appState.cart));
                    updateCartBadge();
                    renderCart();
                }
            }
        }

        function removeFromCart(itemName) {
            appState.cart = appState.cart.filter(item => item.name !== itemName);
            localStorage.setItem('gastroneo_cart', JSON.stringify(appState.cart));
            updateCartBadge();
            renderCart();
            createNotification('warning', 'üóëÔ∏è Producto Eliminado', `${itemName} removido del carrito`);
        }

        // === CHECKOUT ===
        function renderCheckout() {
            const itemsContainer = document.getElementById('checkoutOrderItems');
            const totalElement = document.getElementById('checkoutTotal');
            
            let total = 0;
            itemsContainer.innerHTML = appState.cart.map(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                return `
                    <div style="display:flex;justify-content:space-between;font-size:0.9rem;margin-bottom:0.5rem;padding:0.3rem 0;">
                        <span>${item.name} x${item.quantity}</span>
                        <span style="color: var(--neo-accent);">‚Ç¨${itemTotal.toFixed(2)}</span>
                    </div>
                `;
            }).join('');
            
            totalElement.textContent = total.toFixed(2);
            
            // Rellenar datos del usuario si existe
            if (appState.user) {
                document.getElementById('checkoutName').value = appState.user.name || '';
                document.getElementById('checkoutEmail').value = appState.user.email || '';
            }
        }

        function selectPaymentMethod(method) {
            appState.selectedPaymentMethod = method;
            
            // Resetear todos los botones
            document.querySelectorAll('.btn-neo').forEach(btn => {
                btn.style.border = 'none';
            });
            
            // Resaltar el bot√≥n seleccionado
            event.target.style.border = '2px solid var(--neo-accent)';
            
            createNotification('info', 'üí≥ M√©todo Seleccionado', `Pago con ${method === 'card' ? 'Tarjeta' : method === 'cash' ? 'Efectivo' : 'PayPal'}`);
        }

        function processCheckout() {
            if (!appState.selectedPaymentMethod) {
                alert("‚ùå Por favor, selecciona un m√©todo de pago.");
                return;
            }

            const name = document.getElementById('checkoutName').value;
            const email = document.getElementById('checkoutEmail').value;
            const phone = document.getElementById('checkoutPhone').value;

            if (!name || !email || !phone) {
                alert("‚ùå Por favor, completa todos los datos de contacto.");
                return;
            }

            const total = appState.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const mesaEscaneada = localStorage.getItem('gastroneo_mesa_escaneada');
            
            // Simular procesamiento de pago
            const paymentMethods = {
                'card': 'Tarjeta de Cr√©dito',
                'cash': 'Efectivo',
                'paypal': 'PayPal'
            };
            
            let mensaje = `‚úÖ ¬°Pago realizado con √©xito!\n`;
            mensaje += `üí≥ M√©todo: ${paymentMethods[appState.selectedPaymentMethod]}\n`;
            mensaje += `üí∞ Total: ‚Ç¨${total.toFixed(2)}\n`;
            
            if (mesaEscaneada) {
                mensaje += `üçΩÔ∏è Mesa: ${mesaEscaneada}\n`;
            }
            
            mensaje += `\nüìß Recibir√°s un email de confirmaci√≥n en: ${email}`;
            
            // A√±adir tokens al usuario por la compra
            if (appState.user) {
                const tokensEarned = Math.floor(total);
                appState.user.tokens = (appState.user.tokens || 0) + tokensEarned;
                localStorage.setItem('gastroneo_user', JSON.stringify(appState.user));
                mensaje += `\n\nüéÅ +${tokensEarned} GastroTokens ganados!`;
            }
            
            alert(mensaje);
            
            // Limpiar carrito
            appState.cart = [];
            localStorage.setItem('gastroneo_cart', JSON.stringify(appState.cart));
            updateCartBadge();
            
            createNotification('success', 'üéâ ¬°Compra Exitosa!', `Pedido procesado por ‚Ç¨${total.toFixed(2)}`);
            addActivity('positive', `Nueva venta: ‚Ç¨${total.toFixed(2)} - ${paymentMethods[appState.selectedPaymentMethod]}`);
            
            showView('homeView');
        }

        // === GASTROPASS ===
        function redeemReward(cost, item) {
            if (!appState.user) { 
                alert("‚ùå Crea una cuenta para canjear recompensas."); 
                return; 
            }
            
            if (appState.user.tokens < cost) { 
                alert(`‚ùå Necesitas ${cost} tokens. Tienes ${appState.user.tokens}.`); 
                return; 
            }
            
            if (!confirm(`¬øCanjear ${item} por ${cost} GastroTokens?`)) {
                return;
            }
            
            appState.user.tokens -= cost;
            localStorage.setItem('gastroneo_user', JSON.stringify(appState.user));
            
            alert(`üéâ ¬°Canjeado exitosamente!\n${item} - ${cost} GastroTokens`);
            renderUserProfile();
            
            createNotification('success', 'üéÅ Recompensa Canjeada', `${item} - ${cost} tokens`);
            addActivity('positive', `Usuario canje√≥: ${item} por ${cost} tokens`);
        }

        // === ESCANER QR ===
        function simulateQRScan() {
            const mesaAleatoria = Math.floor(Math.random() * 12) + 1;
            localStorage.setItem('gastroneo_mesa_escaneada', mesaAleatoria);
            
            alert(`üì± ¬°QR Escaneado!\n‚úÖ Mesa ${mesaAleatoria} detectada\n\nRedirigiendo al men√∫...`);
            
            createNotification('success', 'üîç QR Escaneado', `Mesa ${mesaAleatoria} identificada`);
            addActivity('positive', `Cliente escane√≥ QR - Mesa ${mesaAleatoria}`);
            
            showView('menuView');
        }

        function checkMesaEscaneada() {
            const mesa = localStorage.getItem('gastroneo_mesa_escaneada');
            const mesaInfo = document.getElementById('mesaInfo');
            const currentMesa = document.getElementById('currentMesa');
            const mesaInfoCart = document.getElementById('mesaInfoCart');
            const currentMesaCart = document.getElementById('currentMesaCart');
            
            if (mesa) {
                mesaInfo.style.display = 'block';
                currentMesa.textContent = mesa;
                mesaInfoCart.style.display = 'block';
                currentMesaCart.textContent = mesa;
            }
        }

        // === RESERVAS ===
        function confirmBooking() {
            if (!appState.user) {
                alert("‚ùå Por favor, crea una cuenta primero.");
                return;
            }

            const name = document.getElementById('clientName').value;
            const phone = document.getElementById('clientPhone').value;
            const date = document.getElementById('bookingDate').value;
            const time = document.getElementById('bookingTime').value;
            const guests = document.getElementById('guests').value;

            if (!name || !phone || !date || !time) {
                alert("‚ùå Por favor, completa todos los campos.");
                return;
            }

            // A√±adir tokens por reserva
            appState.user.tokens = (appState.user.tokens || 0) + 100;
            localStorage.setItem('gastroneo_user', JSON.stringify(appState.user));
            
            let mensaje = `‚úÖ ¬°Reserva confirmada!\n\n`;
            mensaje += `üë§ Nombre: ${name}\n`;
            mensaje += `üìû Tel√©fono: ${phone}\n`;
            mensaje += `üìÖ Fecha: ${date}\n`;
            mensaje += `‚è∞ Hora: ${time}\n`;
            mensaje += `üë• Comensales: ${guests}\n\n`;
            mensaje += `üéÅ +100 GastroTokens`;
            
            alert(mensaje);
            
            createNotification('success', 'üìÖ Reserva Confirmada', `Mesa para ${guests} personas - ${time}`);
            addActivity('positive', `Nueva reserva: ${name} - ${guests} personas`);
            
            showView('homeView');
        }

        // === EMPLEADOS ===
        function loginEmployee() {
            const pin = document.getElementById('employeePin').value;
            if (pin === "9876") {
                appState.employee = { 
                    name: "Empleado Demo", 
                    role: "mesero",
                    id: 'demo_emp'
                };
                localStorage.setItem('gastroneo_current_employee', JSON.stringify(appState.employee));
                showView('employeeDashboard');
                createNotification('success', 'üë®‚Äçüíº Sesi√≥n Iniciada', 'Panel de empleados activo');
                addActivity('positive', 'Empleado inici√≥ sesi√≥n en el panel');
            } else {
                alert("‚ùå PIN incorrecto. Intenta con 9876");
            }
        }

        function logoutEmployee() {
            appState.employee = null;
            localStorage.removeItem('gastroneo_current_employee');
            showView('homeView');
            createNotification('info', 'üëã Sesi√≥n Cerrada', 'Panel de empleados cerrado');
        }

        function renderEmployeeLeaderboard() {
            const container = document.getElementById('employeeLeaderboard');
            if (!container) return;

            const sortedEmployees = [...appState.employees].sort((a, b) => b.points - a.points);
            
            container.innerHTML = sortedEmployees.map((emp, index) => {
                const rankClass = index === 0 ? 'rank-diamante' : 
                                index === 1 ? 'rank-oro' : 
                                index === 2 ? 'rank-plata' : 'rank-bronce';
                
                return `
                    <div class="leaderboard-item">
                        <div class="rank-badge ${rankClass}">${index + 1}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: var(--neo-accent);">${emp.name}</div>
                            <div style="font-size: 0.8rem; color: var(--neo-text-secondary);">
                                ${emp.points} pts ‚Ä¢ ${emp.level.toUpperCase()}
                                ${emp.todayPoints !== 0 ? 
                                    `<span style="color: ${emp.todayPoints > 0 ? '#00FF00' : '#FF4444'}; font-weight: 600;">
                                        ${emp.todayPoints > 0 ? '+' : ''}${emp.todayPoints}
                                    </span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderOwnerLeaderboard() {
            const container = document.getElementById('ownerLeaderboard');
            if (!container) return;

            const sortedEmployees = [...appState.employees].sort((a, b) => b.points - a.points);
            
            container.innerHTML = sortedEmployees.map((emp, index) => {
                const rankClass = index === 0 ? 'rank-diamante' : 
                                index === 1 ? 'rank-oro' : 
                                index === 2 ? 'rank-plata' : 'rank-bronce';
                
                return `
                    <div class="leaderboard-item">
                        <div class="rank-badge ${rankClass}">${emp.points}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">${emp.name}</div>
                            <div style="font-size: 0.8rem; color: var(--neo-text-secondary);">
                                ${emp.level.toUpperCase()} 
                                ‚Ä¢ Hoy: 
                                <span style="color: ${emp.todayPoints > 0 ? '#00FF00' : '#FF4444'};">
                                    ${emp.todayPoints > 0 ? '+' : ''}${emp.todayPoints}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderTablesGrid() {
            const grid = document.getElementById('tablesGrid');
            if (!grid) return;

            grid.innerHTML = '';
            for (let i = 1; i <= 12; i++) {
                const status = i <= 8 ? 'occupied' : 'free';
                const card = document.createElement('div');
                card.className = `table-card table-${status}`;
                card.innerHTML = `
                    <div style="font-size: 1.2rem; font-weight: 700;">${i}</div>
                    <div style="font-size: 0.7rem; margin-top: 0.2rem;">${status === 'free' ? 'üü¢ Libre' : 'üî¥ Ocupada'}</div>
                `;
                card.onclick = () => openTableDetail(i, status);
                grid.appendChild(card);
            }
        }

        function openTableDetail(tableNum, status) {
            if (status === 'free') {
                alert(`üìã Mesa ${tableNum} - LIBRE\n\n¬øQuieres asignar esta mesa?`);
            } else {
                alert(`üìã Mesa ${tableNum} - OCUPADA\n\nClientes: 4 personas\nPedido: En proceso\nTiempo: 25 minutos`);
            }
        }

        // === PANEL QUANTUM (DUE√ëO) ===
        function openOwnerAccess() {
            const pin = prompt("üîê PANEL QUANTUM\n\nIngresa el PIN de acceso:");
            if (pin === "1234") {
                showView('ownerDashboard');
                createNotification('success', 'üîê Acceso Concedido', 'Panel Quantum activado');
                addActivity('positive', 'Due√±o accedi√≥ al Panel Quantum');
            } else if (pin) {
                alert("‚ùå PIN incorrecto. Acceso denegado.");
                createNotification('danger', 'üö´ Acceso Denegado', 'Intento fallido de acceso al Panel Quantum');
            }
        }

        function logoutOwner() {
            showView('homeView');
            createNotification('info', 'üîí Sesi√≥n Cerrada', 'Panel Quantum desactivado');
        }

        function verifyAllOrders() {
            // Simular verificaci√≥n de pedidos
            const pendingOrders = Math.floor(Math.random() * 5) + 1;
            
            alert(`‚úÖ Verificaci√≥n completada\n\nüìä ${pendingOrders} pedidos verificados\nüîÑ Sistema actualizado`);
            
            createNotification('success', '‚úÖ Verificaci√≥n Exitosa', `${pendingOrders} pedidos verificados`);
            addActivity('positive', `Sistema: ${pendingOrders} pedidos verificados autom√°ticamente`);
            
            // Actualizar m√©tricas
            document.getElementById('pendingOrders').textContent = '0';
        }

        // === ACTIVIDAD EN VIVO ===
        function startLiveActivities() {
            // Actividades iniciales
            addActivity('positive', 'üöÄ Sistema GastroNeo Quantum iniciado');
            addActivity('positive', 'üì± Aplicaci√≥n cargada correctamente');
            addActivity('neutral', 'üîß Todos los sistemas operativos');
            
            // Simular actividad cada 15-25 segundos
            setInterval(() => {
                const activities = [
                    'positive: Carlos +10pts: Cliente elogi√≥ servicio en Mesa 3',
                    'positive: Ana +8pts: Upselling exitoso en Mesa 7',
                    'negative: Luis -12pts: Tiempo excedido en pedido Mesa 5',
                    'positive: Sistema: Nuevo pedido completado - Mesa 8',
                    'neutral: Inventario: Stock bajo en ingrediente premium',
                    'positive: Mar√≠a +15pts: Cliente frecuente muy satisfecho'
                ];
                const randomActivity = activities[Math.floor(Math.random() * activities.length)];
                const [type, message] = randomActivity.split(': ');
                addActivity(type, message);
                
                // Actualizar leaderboards si es una actividad de empleados
                if (message.includes('+') || message.includes('-')) {
                    renderEmployeeLeaderboard();
                    renderOwnerLeaderboard();
                }
            }, 15000 + Math.random() * 10000);
        }

        function addActivity(type, message) {
            const activity = {
                id: Date.now(),
                type: type,
                message: message,
                timestamp: new Date().toLocaleTimeString('es-ES', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: '2-digit'
                })
            };
            
            appState.activities.unshift(activity);
            appState.activities = appState.activities.slice(0, 8); // Mantener solo 8 actividades
            renderActivityFeed();
        }

        function renderActivityFeed() {
            const feed = document.getElementById('liveActivityFeed');
            if (!feed) return;
            
            feed.innerHTML = appState.activities.map(activity => `
                <div class="activity-item activity-${activity.type}">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="flex: 1;">${activity.message}</div>
                        <div style="font-size: 0.7rem; color: var(--neo-text-secondary); white-space: nowrap;">
                            ${activity.timestamp}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // === NOTIFICACIONES ===
        function createNotification(type, title, message) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                    <div style="font-family: 'Orbitron'; font-weight: 700; font-size: 0.9rem;">${title}</div>
                    <div style="font-size: 0.7rem; color: var(--neo-text-secondary); white-space: nowrap;">Ahora</div>
                </div>
                <div style="font-size: 0.85rem; line-height: 1.3;">${message}</div>
            `;
            
            container.appendChild(notification);
            
            // Auto-remover despu√©s de 6 segundos
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 6000);
        }

        // === SERVICE WORKER PARA PWA ===
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker registrado:', registration);
                    })
                    .catch(error => {
                        console.log('‚ùå Error registrando Service Worker:', error);
                    });
            });
        }

        // === MANIFEST PWA ===
        const manifest = {
            "name": "GastroNeo Quantum",
            "short_name": "GastroNeo",
            "description": "Restaurante del Futuro con IA y Gamificaci√≥n",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#0D0916",
            "theme_color": "#FF2A6D",
            "orientation": "portrait",
            "icons": [
                {
                    "src": "icon-192.png",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "icon-512.png", 
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };

        console.log('üöÄ GastroNeo Quantum - Sistema 100% Operativo');
        console.log('üìä Estado:', appState);
        console.log('üéØ Carrito:', appState.cart.length + ' items');
        console.log('üë• Empleados:', appState.employees.length);
    </script>
</body>
</html>
